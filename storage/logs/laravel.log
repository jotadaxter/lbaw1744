[2018-04-12 11:26:01] local.ERROR: SQLSTATE[08006] [7] could not connect to server: Connection refused
	Is the server running on host "localhost" (127.0.0.1) and accepting
	TCP/IP connections on port 5432? {"exception":"[object] (PDOException(code: 7): SQLSTATE[08006] [7] could not connect to server: Connection refused
\tIs the server running on host \"localhost\" (127.0.0.1) and accepting
\tTCP/IP connections on port 5432? at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connectors/Connector.php:67)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connectors/Connector.php(67): PDO->__construct('pgsql:host=loca...', 'postgres', 'pg!fcp', Array)
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connectors/Connector.php(43): Illuminate\\Database\\Connectors\\Connector->createPdoConnection('pgsql:host=loca...', 'postgres', 'pg!fcp', Array)
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connectors/PostgresConnector.php(33): Illuminate\\Database\\Connectors\\Connector->createConnection('pgsql:host=loca...', Array, Array)
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connectors/ConnectionFactory.php(183): Illuminate\\Database\\Connectors\\PostgresConnector->connect(Array)
#4 [internal function]: Illuminate\\Database\\Connectors\\ConnectionFactory->Illuminate\\Database\\Connectors\\{closure}()
#5 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(915): call_user_func(Object(Closure))
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(507): Illuminate\\Database\\Connection->getPdo()
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(657): Illuminate\\Database\\Connection->Illuminate\\Database\\{closure}('DROP TABLE IF E...', Array)
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TABLE IF E...', Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TABLE IF E...', Array, Object(Closure))
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TABLE IF E...')
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#12 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#13 [internal function]: DatabaseSeeder->run()
#14 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#22 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#27 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#28 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#29 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#30 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#31 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#32 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#33 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#34 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#35 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#36 {main}
"} 
[2018-04-12 11:26:01] local.ERROR: SQLSTATE[08006] [7] could not connect to server: Connection refused
	Is the server running on host "localhost" (127.0.0.1) and accepting
	TCP/IP connections on port 5432? (SQL: DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS cards CASCADE;
DROP TABLE IF EXISTS items CASCADE;

CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name VARCHAR NOT NULL,
  email VARCHAR UNIQUE NOT NULL,
  password VARCHAR NOT NULL,
  remember_token VARCHAR
);

CREATE TABLE cards (
  id SERIAL PRIMARY KEY,
  name VARCHAR NOT NULL,
  user_id INTEGER REFERENCES users NOT NULL
);

CREATE TABLE items (
  id SERIAL PRIMARY KEY,
  card_id INTEGER NOT NULL REFERENCES cards ON DELETE CASCADE,
  description VARCHAR NOT NULL,
  done BOOLEAN NOT NULL DEFAULT FALSE
);

INSERT INTO users VALUES (
  DEFAULT,
  'John Doe',
  'john@example.com',
  '$2y$10$HfzIhGCCaxqyaIdGgjARSuOKAcm1Uy82YfLuNaajn6JrjLWy9Sj/W'
); -- Password is 1234. Generated using Hash::make('1234')

INSERT INTO cards VALUES (DEFAULT, 'Things to do', 1);
INSERT INTO items VALUES (DEFAULT, 1, 'Buy milk');
INSERT INTO items VALUES (DEFAULT, 1, 'Walk the dog', true);

INSERT INTO cards VALUES (DEFAULT, 'Things not to do', 1);
INSERT INTO items VALUES (DEFAULT, 2, 'Break a leg');
INSERT INTO items VALUES (DEFAULT, 2, 'Crash the car');
) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 7): SQLSTATE[08006] [7] could not connect to server: Connection refused
\tIs the server running on host \"localhost\" (127.0.0.1) and accepting
\tTCP/IP connections on port 5432? (SQL: DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS cards CASCADE;
DROP TABLE IF EXISTS items CASCADE;

CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name VARCHAR NOT NULL,
  email VARCHAR UNIQUE NOT NULL,
  password VARCHAR NOT NULL,
  remember_token VARCHAR
);

CREATE TABLE cards (
  id SERIAL PRIMARY KEY,
  name VARCHAR NOT NULL,
  user_id INTEGER REFERENCES users NOT NULL
);

CREATE TABLE items (
  id SERIAL PRIMARY KEY,
  card_id INTEGER NOT NULL REFERENCES cards ON DELETE CASCADE,
  description VARCHAR NOT NULL,
  done BOOLEAN NOT NULL DEFAULT FALSE
);

INSERT INTO users VALUES (
  DEFAULT,
  'John Doe',
  'john@example.com',
  '$2y$10$HfzIhGCCaxqyaIdGgjARSuOKAcm1Uy82YfLuNaajn6JrjLWy9Sj/W'
); -- Password is 1234. Generated using Hash::make('1234')

INSERT INTO cards VALUES (DEFAULT, 'Things to do', 1);
INSERT INTO items VALUES (DEFAULT, 1, 'Buy milk');
INSERT INTO items VALUES (DEFAULT, 1, 'Walk the dog', true);

INSERT INTO cards VALUES (DEFAULT, 'Things not to do', 1);
INSERT INTO items VALUES (DEFAULT, 2, 'Break a leg');
INSERT INTO items VALUES (DEFAULT, 2, 'Crash the car');
) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 7): SQLSTATE[08006] [7] could not connect to server: Connection refused
\tIs the server running on host \"localhost\" (127.0.0.1) and accepting
\tTCP/IP connections on port 5432? at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connectors/Connector.php:67)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TABLE IF E...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TABLE IF E...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TABLE IF E...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-24 17:26:58] local.ERROR: There are no commands defined in the "bd" namespace. {"exception":"[object] (Symfony\\Component\\Console\\Exception\\CommandNotFoundException(code: 0): There are no commands defined in the \"bd\" namespace. at /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php:564)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(604): Symfony\\Component\\Console\\Application->findNamespace('bd')
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(229): Symfony\\Component\\Console\\Application->find('bd:seed')
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#4 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#5 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#6 {main}
"} 
[2018-04-28 13:48:09] local.ERROR: SQLSTATE[42601]: Syntax error: 7 ERROR:  syntax error at or near "NOT"
LINE 66:  hidden NOT NULL boolean,
                 ^ (SQL: DROP TYPE IF EXISTS userstate CASCADE;
DROP TABLE IF EXISTS Users CASCADE;
DROP TABLE IF EXISTS Sellers CASCADE;
DROP TABLE IF EXISTS Products CASCADE;
DROP TYPE IF EXISTS paymentmethod CASCADE;
DROP TABLE IF EXISTS SerialKeys CASCADE;
DROP TABLE IF EXISTS Discounts CASCADE;
DROP TABLE IF EXISTS Purchases CASCADE;
DROP TABLE IF EXISTS Reviews CASCADE;
DROP TABLE IF EXISTS Tags CASCADE;
DROP TABLE IF EXISTS PurchasedKeys CASCADE;
DROP TABLE IF EXISTS Wishlists CASCADE;
DROP TABLE IF EXISTS ProductImages CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
	hidden NOT NULL boolean,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences


CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42601): SQLSTATE[42601]: Syntax error: 7 ERROR:  syntax error at or near \"NOT\"
LINE 66:  hidden NOT NULL boolean,
                 ^ (SQL: DROP TYPE IF EXISTS userstate CASCADE;
DROP TABLE IF EXISTS Users CASCADE;
DROP TABLE IF EXISTS Sellers CASCADE;
DROP TABLE IF EXISTS Products CASCADE;
DROP TYPE IF EXISTS paymentmethod CASCADE;
DROP TABLE IF EXISTS SerialKeys CASCADE;
DROP TABLE IF EXISTS Discounts CASCADE;
DROP TABLE IF EXISTS Purchases CASCADE;
DROP TABLE IF EXISTS Reviews CASCADE;
DROP TABLE IF EXISTS Tags CASCADE;
DROP TABLE IF EXISTS PurchasedKeys CASCADE;
DROP TABLE IF EXISTS Wishlists CASCADE;
DROP TABLE IF EXISTS ProductImages CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
\thidden NOT NULL boolean,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences


CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42601): SQLSTATE[42601]: Syntax error: 7 ERROR:  syntax error at or near \"NOT\"
LINE 66:  hidden NOT NULL boolean,
                 ^ at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 13:49:42] local.ERROR: SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation "Discounts" already exists (SQL: DROP TYPE IF EXISTS userstate CASCADE;
DROP TABLE IF EXISTS Users CASCADE;
DROP TABLE IF EXISTS Sellers CASCADE;
DROP TABLE IF EXISTS Products CASCADE;
DROP TYPE IF EXISTS paymentmethod CASCADE;
DROP TABLE IF EXISTS SerialKeys CASCADE;
DROP TABLE IF EXISTS Discounts CASCADE;
DROP TABLE IF EXISTS Purchases CASCADE;
DROP TABLE IF EXISTS Reviews CASCADE;
DROP TABLE IF EXISTS Tags CASCADE;
DROP TABLE IF EXISTS PurchasedKeys CASCADE;
DROP TABLE IF EXISTS Wishlists CASCADE;
DROP TABLE IF EXISTS ProductImages CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences


CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation \"Discounts\" already exists (SQL: DROP TYPE IF EXISTS userstate CASCADE;
DROP TABLE IF EXISTS Users CASCADE;
DROP TABLE IF EXISTS Sellers CASCADE;
DROP TABLE IF EXISTS Products CASCADE;
DROP TYPE IF EXISTS paymentmethod CASCADE;
DROP TABLE IF EXISTS SerialKeys CASCADE;
DROP TABLE IF EXISTS Discounts CASCADE;
DROP TABLE IF EXISTS Purchases CASCADE;
DROP TABLE IF EXISTS Reviews CASCADE;
DROP TABLE IF EXISTS Tags CASCADE;
DROP TABLE IF EXISTS PurchasedKeys CASCADE;
DROP TABLE IF EXISTS Wishlists CASCADE;
DROP TABLE IF EXISTS ProductImages CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences


CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation \"Discounts\" already exists at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 13:50:06] local.ERROR: SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation "Discounts" already exists (SQL: DROP TYPE IF EXISTS userstate CASCADE;
DROP TABLE IF EXISTS Users CASCADE;
DROP TABLE IF EXISTS Sellers CASCADE;
DROP TABLE IF EXISTS Products CASCADE;
DROP TYPE IF EXISTS paymentmethod CASCADE;
DROP TABLE IF EXISTS SerialKeys CASCADE;
DROP TABLE IF EXISTS Discounts CASCADE;
DROP TABLE IF EXISTS Purchases CASCADE;
DROP TABLE IF EXISTS Reviews CASCADE;
DROP TABLE IF EXISTS Tags CASCADE;
DROP TABLE IF EXISTS PurchasedKeys CASCADE;
DROP TABLE IF EXISTS Wishlists CASCADE;
DROP TABLE IF EXISTS ProductImages CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences


CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation \"Discounts\" already exists (SQL: DROP TYPE IF EXISTS userstate CASCADE;
DROP TABLE IF EXISTS Users CASCADE;
DROP TABLE IF EXISTS Sellers CASCADE;
DROP TABLE IF EXISTS Products CASCADE;
DROP TYPE IF EXISTS paymentmethod CASCADE;
DROP TABLE IF EXISTS SerialKeys CASCADE;
DROP TABLE IF EXISTS Discounts CASCADE;
DROP TABLE IF EXISTS Purchases CASCADE;
DROP TABLE IF EXISTS Reviews CASCADE;
DROP TABLE IF EXISTS Tags CASCADE;
DROP TABLE IF EXISTS PurchasedKeys CASCADE;
DROP TABLE IF EXISTS Wishlists CASCADE;
DROP TABLE IF EXISTS ProductImages CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences


CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation \"Discounts\" already exists at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 13:52:23] local.ERROR: SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation "ProductImages" already exists (SQL: DROP TYPE IF EXISTS userstate CASCADE;
DROP TABLE IF EXISTS Users CASCADE;
DROP TABLE IF EXISTS Sellers CASCADE;
DROP TABLE IF EXISTS Products CASCADE;
DROP TYPE IF EXISTS paymentmethod CASCADE;
DROP TABLE IF EXISTS SerialKeys CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS Purchases CASCADE;
DROP TABLE IF EXISTS Reviews CASCADE;
DROP TABLE IF EXISTS Tags CASCADE;
DROP TABLE IF EXISTS PurchasedKeys CASCADE;
DROP TABLE IF EXISTS Wishlists CASCADE;
DROP TABLE IF EXISTS ProductImages CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences


CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation \"ProductImages\" already exists (SQL: DROP TYPE IF EXISTS userstate CASCADE;
DROP TABLE IF EXISTS Users CASCADE;
DROP TABLE IF EXISTS Sellers CASCADE;
DROP TABLE IF EXISTS Products CASCADE;
DROP TYPE IF EXISTS paymentmethod CASCADE;
DROP TABLE IF EXISTS SerialKeys CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS Purchases CASCADE;
DROP TABLE IF EXISTS Reviews CASCADE;
DROP TABLE IF EXISTS Tags CASCADE;
DROP TABLE IF EXISTS PurchasedKeys CASCADE;
DROP TABLE IF EXISTS Wishlists CASCADE;
DROP TABLE IF EXISTS ProductImages CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences


CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  relation \"ProductImages\" already exists at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 13:52:56] local.ERROR: SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence "SerialGenerator" is already in schema "public" (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences


CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence \"SerialGenerator\" is already in schema \"public\" (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences


CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence \"SerialGenerator\" is already in schema \"public\" at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 13:54:19] local.ERROR: SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence "SerialGenerator" is already in schema "public" (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences

DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence \"SerialGenerator\" is already in schema \"public\" (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences

DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence \"SerialGenerator\" is already in schema \"public\" at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 13:59:31] local.ERROR: SQLSTATE[42601]: Syntax error: 7 ERROR:  syntax error at or near ";"
LINE 3: CREATE SCHEMA "public" AUTHORIZATION;
                                            ^ (SQL: DROP SCHEMA IF EXISTS "public" CASCADE;

CREATE SCHEMA "public" AUTHORIZATION;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences

DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42601): SQLSTATE[42601]: Syntax error: 7 ERROR:  syntax error at or near \";\"
LINE 3: CREATE SCHEMA \"public\" AUTHORIZATION;
                                            ^ (SQL: DROP SCHEMA IF EXISTS \"public\" CASCADE;

CREATE SCHEMA \"public\" AUTHORIZATION;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences

DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42601): SQLSTATE[42601]: Syntax error: 7 ERROR:  syntax error at or near \";\"
LINE 3: CREATE SCHEMA \"public\" AUTHORIZATION;
                                            ^ at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP SCHEMA IF ...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP SCHEMA IF ...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP SCHEMA IF ...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:03:21] local.ERROR: SQLSTATE[42704]: Undefined object: 7 ERROR:  role "lbaw1744" does not exist (SQL: DROP SCHEMA IF EXISTS "public" CASCADE;

CREATE SCHEMA "public" AUTHORIZATION lbaw1744;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences

DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42704): SQLSTATE[42704]: Undefined object: 7 ERROR:  role \"lbaw1744\" does not exist (SQL: DROP SCHEMA IF EXISTS \"public\" CASCADE;

CREATE SCHEMA \"public\" AUTHORIZATION lbaw1744;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences

DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42704): SQLSTATE[42704]: Undefined object: 7 ERROR:  role \"lbaw1744\" does not exist at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP SCHEMA IF ...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP SCHEMA IF ...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP SCHEMA IF ...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:08:03] local.ERROR: SQLSTATE[42704]: Undefined object: 7 ERROR:  role "lbaw1744" does not exist (SQL: DROP SCHEMA IF EXISTS "public" CASCADE;

CREATE SCHEMA "public" AUTHORIZATION lbaw1744;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences

DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42704): SQLSTATE[42704]: Undefined object: 7 ERROR:  role \"lbaw1744\" does not exist (SQL: DROP SCHEMA IF EXISTS \"public\" CASCADE;

CREATE SCHEMA \"public\" AUTHORIZATION lbaw1744;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences

DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42704): SQLSTATE[42704]: Undefined object: 7 ERROR:  role \"lbaw1744\" does not exist at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP SCHEMA IF ...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP SCHEMA IF ...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP SCHEMA IF ...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:08:28] local.ERROR: SQLSTATE[3F000]: Invalid schema name: 7 ERROR:  no schema has been selected to create in (SQL: DROP SCHEMA IF EXISTS "public" CASCADE;



DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences

DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 3F000): SQLSTATE[3F000]: Invalid schema name: 7 ERROR:  no schema has been selected to create in (SQL: DROP SCHEMA IF EXISTS \"public\" CASCADE;



DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences

DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 3F000): SQLSTATE[3F000]: Invalid schema name: 7 ERROR:  no schema has been selected to create in at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP SCHEMA IF ...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP SCHEMA IF ...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP SCHEMA IF ...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:08:41] local.ERROR: SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence "SerialGenerator" is already in schema "public" (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences

DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA public;

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence \"SerialGenerator\" is already in schema \"public\" (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences

DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA public;

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence \"SerialGenerator\" is already in schema \"public\" at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:17:54] local.ERROR: SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence "SerialGenerator" is already in schema "public" (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences

DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE "SerialGenerator";

ALTER SEQUENCE "SerialGenerator" SET SCHEMA "public";

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence \"SerialGenerator\" is already in schema \"public\" (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences

DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE \"SerialGenerator\";

ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA \"public\";

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P07): SQLSTATE[42P07]: Duplicate table: 7 ERROR:  sequence \"SerialGenerator\" is already in schema \"public\" at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:18:49] local.ERROR: SQLSTATE[42P01]: Undefined table: 7 ERROR:  relation "serialgenerator" does not exist (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences

DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE "SerialGenerator";

--ALTER SEQUENCE "SerialGenerator" SET SCHEMA "public";

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P01): SQLSTATE[42P01]: Undefined table: 7 ERROR:  relation \"serialgenerator\" does not exist (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences

DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE \"SerialGenerator\";

--ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA \"public\";

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);


--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P01): SQLSTATE[42P01]: Undefined table: 7 ERROR:  relation \"serialgenerator\" does not exist at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:21:42] local.ERROR: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "id" of relation "Users" does not exist
LINE 303: INSERT INTO "Users"(id, username, password, fullname, phone_...
                              ^ (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences
/*
DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE IF NOT EXISTS "SerialGenerator";

--ALTER SEQUENCE "SerialGenerator" SET SCHEMA "public";

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42703): SQLSTATE[42703]: Undefined column: 7 ERROR:  column \"id\" of relation \"Users\" does not exist
LINE 303: INSERT INTO \"Users\"(id, username, password, fullname, phone_...
                              ^ (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences
/*
DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE IF NOT EXISTS \"SerialGenerator\";

--ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA \"public\";

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42703): SQLSTATE[42703]: Undefined column: 7 ERROR:  column \"id\" of relation \"Users\" does not exist
LINE 303: INSERT INTO \"Users\"(id, username, password, fullname, phone_...
                              ^ at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:27:27] local.ERROR: SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column "hidden" violates not-null constraint
DETAIL:  Failing row contains (200, 105, daw for live mixing and production, 2015-10-20 00:00:00+00, wml, 599, ableton9.jpg, ableton 9 live suite, null). (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences
/*
DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE IF NOT EXISTS "SerialGenerator";

--ALTER SEQUENCE "SerialGenerator" SET SCHEMA "public";

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 23502): SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column \"hidden\" violates not-null constraint
DETAIL:  Failing row contains (200, 105, daw for live mixing and production, 2015-10-20 00:00:00+00, wml, 599, ableton9.jpg, ableton 9 live suite, null). (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences
/*
DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE IF NOT EXISTS \"SerialGenerator\";

--ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA \"public\";

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 23502): SQLSTATE[23502]: Not null violation: 7 ERROR:  null value in column \"hidden\" violates not-null constraint
DETAIL:  Failing row contains (200, 105, daw for live mixing and production, 2015-10-20 00:00:00+00, wml, 599, ableton9.jpg, ableton 9 live suite, null). at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:28:46] local.ERROR: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "id" of relation "Users" does not exist
LINE 303: INSERT INTO "Users"(id, username, password, fullname, phone_...
                              ^ (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences
/*
DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE IF NOT EXISTS "SerialGenerator";

--ALTER SEQUENCE "SerialGenerator" SET SCHEMA "public";

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42703): SQLSTATE[42703]: Undefined column: 7 ERROR:  column \"id\" of relation \"Users\" does not exist
LINE 303: INSERT INTO \"Users\"(id, username, password, fullname, phone_...
                              ^ (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences
/*
DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE IF NOT EXISTS \"SerialGenerator\";

--ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA \"public\";

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42703): SQLSTATE[42703]: Undefined column: 7 ERROR:  column \"id\" of relation \"Users\" does not exist
LINE 303: INSERT INTO \"Users\"(id, username, password, fullname, phone_...
                              ^ at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:29:13] local.ERROR: SQLSTATE[42703]: Undefined column: 7 ERROR:  column "assignment_id" of relation "SerialKeys" does not exist
LINE 358: INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, c...
                                          ^ (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences
/*
DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE IF NOT EXISTS "SerialGenerator";

--ALTER SEQUENCE "SerialGenerator" SET SCHEMA "public";

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42703): SQLSTATE[42703]: Undefined column: 7 ERROR:  column \"assignment_id\" of relation \"SerialKeys\" does not exist
LINE 358: INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, c...
                                          ^ (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences
/*
DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE IF NOT EXISTS \"SerialGenerator\";

--ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA \"public\";

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42703): SQLSTATE[42703]: Undefined column: 7 ERROR:  column \"assignment_id\" of relation \"SerialKeys\" does not exist
LINE 358: INSERT INTO \"SerialKeys\"(sk_id, assignment_id, product_id, c...
                                          ^ at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:30:26] local.ERROR: SQLSTATE[42710]: Duplicate object: 7 ERROR:  type "invoicestate" already exists (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences
/*
DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE IF NOT EXISTS "SerialGenerator";

--ALTER SEQUENCE "SerialGenerator" SET SCHEMA "public";

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42710): SQLSTATE[42710]: Duplicate object: 7 ERROR:  type \"invoicestate\" already exists (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences
/*
DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE IF NOT EXISTS \"SerialGenerator\";

--ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA \"public\";

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );

) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42710): SQLSTATE[42710]: Duplicate object: 7 ERROR:  type \"invoicestate\" already exists at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:31:16] local.ERROR: SQLSTATE[42710]: Duplicate object: 7 ERROR:  type "invoicestate" already exists (SQL: DROP TYPE IF EXISTS "userstate" CASCADE;
DROP TABLE IF EXISTS "Users" CASCADE;
DROP TABLE IF EXISTS "Sellers" CASCADE;
DROP TABLE IF EXISTS "Products" CASCADE;
DROP TYPE IF EXISTS "paymentmethod" CASCADE;
DROP TABLE IF EXISTS "SerialKeys" CASCADE;
DROP TABLE IF EXISTS "Discounts" CASCADE;
DROP TABLE IF EXISTS "Purchases" CASCADE;
DROP TABLE IF EXISTS "Reviews" CASCADE;
DROP TABLE IF EXISTS "Tags" CASCADE;
DROP TABLE IF EXISTS "PurchasedKeys" CASCADE;
DROP TABLE IF EXISTS "Wishlists" CASCADE;
DROP TABLE IF EXISTS "ProductImages" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
	'Closed'
);


	-- Tables

CREATE TABLE "Discounts" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT "Discounts_check" CHECK (end_date > begin_date),
    CONSTRAINT "Discounts_discounted_price_check" CHECK (discounted_price >= 0.)
);


CREATE TABLE "ProductImages" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE "Products" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT "Products_price_check" CHECK (price >= 0.)
);


CREATE TABLE "Purchases" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE "Reviews" (
	sk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    "comment" text
);


CREATE TABLE "Sellers" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE "SerialKeys" (
	sk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE "Tags" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE "Users" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    "state" userstate DEFAULT 'Active' NOT NULL,
    "admin" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE "Wishlists" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE "PurchasedKeys" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE "Invoices" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT "Payments_check" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



	-- Primary Keys and Uniques


ALTER TABLE ONLY "Discounts"
    ADD CONSTRAINT "Discounts_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_pkey" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_name_key" UNIQUE (name);


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_pkey" PRIMARY KEY (product_id);


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_pkey" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_pkey" PRIMARY KEY (sk_id);

ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_professional_email_key" UNIQUE (professional_email);


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_key" UNIQUE (user_id);


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_pkey" PRIMARY KEY (sk_id);


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_pkey" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_email_key" UNIQUE (email);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_pkey" PRIMARY KEY (user_id);


ALTER TABLE ONLY "Users"
    ADD CONSTRAINT "Users_username_key" UNIQUE (username);


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_pkey" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_pkey" PRIMARY KEY (sk_id, purchase_id);



	-- Foreign Keys


ALTER TABLE ONLY "ProductImages"
    ADD CONSTRAINT "ProductImages_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Products"
    ADD CONSTRAINT "Products_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Sellers"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Purchases"
    ADD CONSTRAINT "Purchases_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Reviews"
    ADD CONSTRAINT "Reviews_purchase_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Sellers"
    ADD CONSTRAINT "Sellers_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "SerialKeys"
    ADD CONSTRAINT "SerialKeys_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Tags"
    ADD CONSTRAINT "Tags_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_product_id_fkey" FOREIGN KEY (product_id) REFERENCES "Products"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "Wishlists"
    ADD CONSTRAINT "Wishlists_user_id_fkey" FOREIGN KEY (user_id) REFERENCES "Users"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_sk_id_fkey" FOREIGN KEY (sk_id) REFERENCES "SerialKeys"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY "PurchasedKeys"
    ADD CONSTRAINT "PurchasedKeys_purchase_id_fkey" FOREIGN KEY (purchase_id) REFERENCES "Purchases"(purchase_id) ON UPDATE CASCADE;



	-- Sequences
/*
DROP SEQUENCE IF EXISTS "SerialGenerator" CASCADE;

CREATE SEQUENCE IF NOT EXISTS "SerialGenerator";

--ALTER SEQUENCE "SerialGenerator" SET SCHEMA "public";

ALTER TABLE ONLY "Products"
	ALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Users"
	ALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "SerialKeys"
	ALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Purchases"
	ALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
	
ALTER TABLE ONLY "Invoices"
	ALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM "Users";
DELETE FROM "Sellers";
DELETE FROM "Products";
DELETE FROM "Discounts";
DELETE FROM "Purchases";
DELETE FROM "Reviews";
DELETE FROM "Wishlists";
DELETE FROM "ProductImages";
DELETE FROM "Tags";
DELETE FROM "SerialKeys";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO "Users"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO "Sellers"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO "Products" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO "ProductImages"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO "ProductImages"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO "Tags"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO "Tags"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO "Tags"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO "Tags"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO "Tags"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO "Tags"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO "Tags"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO "Tags"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO "Tags"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO "SerialKeys"(sk_id, user_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO "Reviews"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO "Discounts"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO "Purchases"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO "Wishlists"(user_id, product_id) VALUES (100, 209);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (101, 208);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (102, 207);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (103, 206);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (104, 205);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (105, 204);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (106, 203);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (107, 202);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (108, 201);
INSERT INTO "Wishlists"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO "PurchasedKeys"(sk_id, purchase_id, price) VALUES (505, 805,52 );) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42710): SQLSTATE[42710]: Duplicate object: 7 ERROR:  type \"invoicestate\" already exists (SQL: DROP TYPE IF EXISTS \"userstate\" CASCADE;
DROP TABLE IF EXISTS \"Users\" CASCADE;
DROP TABLE IF EXISTS \"Sellers\" CASCADE;
DROP TABLE IF EXISTS \"Products\" CASCADE;
DROP TYPE IF EXISTS \"paymentmethod\" CASCADE;
DROP TABLE IF EXISTS \"SerialKeys\" CASCADE;
DROP TABLE IF EXISTS \"Discounts\" CASCADE;
DROP TABLE IF EXISTS \"Purchases\" CASCADE;
DROP TABLE IF EXISTS \"Reviews\" CASCADE;
DROP TABLE IF EXISTS \"Tags\" CASCADE;
DROP TABLE IF EXISTS \"PurchasedKeys\" CASCADE;
DROP TABLE IF EXISTS \"Wishlists\" CASCADE;
DROP TABLE IF EXISTS \"ProductImages\" CASCADE;


CREATE TYPE paymentmethod AS ENUM (
    'Credit Card',
    'PayPal',
    'Banking Transfer'
);


CREATE TYPE invoicestate AS ENUM (
    'Payment received',
    'Awaiting Payment',
    'Canceled'
);


CREATE TYPE userstate AS ENUM (
    'Active',
    'Inactive',
    'Blocked',
    'Banned',
\t'Closed'
);


\t-- Tables

CREATE TABLE \"Discounts\" (
    product_id integer NOT NULL,
    discounted_price double precision NOT NULL,
    begin_date timestamp with time zone DEFAULT now() NOT NULL,
    end_date timestamp with time zone NOT NULL,
    CONSTRAINT \"Discounts_check\" CHECK (end_date > begin_date),
    CONSTRAINT \"Discounts_discounted_price_check\" CHECK (discounted_price >= 0.)
);


CREATE TABLE \"ProductImages\" (
    product_id integer NOT NULL,
    img_path text NOT NULL
);


CREATE TABLE \"Products\" (
    product_id integer NOT NULL,
    user_id integer NOT NULL,
    description text NOT NULL,
    release_date timestamp with time zone NOT NULL,
    operating_system text NOT NULL,
    price double precision NOT NULL,
    logo_path text NOT NULL,
    name text NOT NULL,
    hidden boolean NOT NULL,
    CONSTRAINT \"Products_price_check\" CHECK (price >= 0.)
);


CREATE TABLE \"Purchases\" (
    purchase_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    paid_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    details text,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);


CREATE TABLE \"Reviews\" (
\tsk_id integer NOT NULL,
    rating integer NOT NULL,
    review_date timestamp with time zone DEFAULT now() NOT NULL,
    \"comment\" text
);


CREATE TABLE \"Sellers\" (
    user_id integer NOT NULL,
    professional_email text NOT NULL,
    professional_name text NOT NULL,
    professional_phone integer NOT NULL
);


CREATE TABLE \"SerialKeys\" (
\tsk_id integer NOT NULL,
    user_id integer,
    product_id integer NOT NULL,
    code text NOT NULL
);


CREATE TABLE \"Tags\" (
    product_id integer NOT NULL,
    tag_name text NOT NULL
);


CREATE TABLE \"Users\" (
    user_id integer NOT NULL,
    username text NOT NULL,
    password text NOT NULL,
    fullname text,
    email text NOT NULL,
    phone_number integer,
    birth_date timestamp with time zone NOT NULL,
    admission_date timestamp with time zone DEFAULT now() NOT NULL,
    \"state\" userstate DEFAULT 'Active' NOT NULL,
    \"admin\" boolean DEFAULT false NOT NULL,
    img text,
    nif integer
);


CREATE TABLE \"Wishlists\" (
    user_id integer NOT NULL,
    product_id integer NOT NULL
);

CREATE TABLE \"PurchasedKeys\" (
    sk_id integer NOT NULL,
    purchase_id integer NOT NULL,
    price double precision NOT NULL
);

CREATE TABLE \"Invoices\" (
    invoice_id integer NOT NULL,
    final_price double precision NOT NULL,
    user_id integer NOT NULL,
    emission_date timestamp with time zone DEFAULT now() NOT NULL,
    payment_method paymentmethod,
    state invoicestate,
    CONSTRAINT \"Payments_check\" CHECK ((final_price > 0. AND payment_method <> NULL) OR (final_price = 0. AND payment_method = NULL))
);



\t-- Primary Keys and Uniques


ALTER TABLE ONLY \"Discounts\"
    ADD CONSTRAINT \"Discounts_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_pkey\" PRIMARY KEY (product_id, img_path);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_name_key\" UNIQUE (name);


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_pkey\" PRIMARY KEY (product_id);


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_pkey\" PRIMARY KEY (purchase_id);


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_pkey\" PRIMARY KEY (sk_id);

ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_professional_email_key\" UNIQUE (professional_email);


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_key\" UNIQUE (user_id);


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_pkey\" PRIMARY KEY (sk_id);


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_pkey\" PRIMARY KEY (product_id, tag_name);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_email_key\" UNIQUE (email);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_pkey\" PRIMARY KEY (user_id);


ALTER TABLE ONLY \"Users\"
    ADD CONSTRAINT \"Users_username_key\" UNIQUE (username);


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_pkey\" PRIMARY KEY (user_id, product_id);


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_pkey\" PRIMARY KEY (sk_id, purchase_id);



\t-- Foreign Keys


ALTER TABLE ONLY \"ProductImages\"
    ADD CONSTRAINT \"ProductImages_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Products\"
    ADD CONSTRAINT \"Products_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Sellers\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Purchases\"
    ADD CONSTRAINT \"Purchases_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Reviews\"
    ADD CONSTRAINT \"Reviews_purchase_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Sellers\"
    ADD CONSTRAINT \"Sellers_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"SerialKeys\"
    ADD CONSTRAINT \"SerialKeys_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Tags\"
    ADD CONSTRAINT \"Tags_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_product_id_fkey\" FOREIGN KEY (product_id) REFERENCES \"Products\"(product_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"Wishlists\"
    ADD CONSTRAINT \"Wishlists_user_id_fkey\" FOREIGN KEY (user_id) REFERENCES \"Users\"(user_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_sk_id_fkey\" FOREIGN KEY (sk_id) REFERENCES \"SerialKeys\"(sk_id) ON UPDATE CASCADE;


ALTER TABLE ONLY \"PurchasedKeys\"
    ADD CONSTRAINT \"PurchasedKeys_purchase_id_fkey\" FOREIGN KEY (purchase_id) REFERENCES \"Purchases\"(purchase_id) ON UPDATE CASCADE;



\t-- Sequences
/*
DROP SEQUENCE IF EXISTS \"SerialGenerator\" CASCADE;

CREATE SEQUENCE IF NOT EXISTS \"SerialGenerator\";

--ALTER SEQUENCE \"SerialGenerator\" SET SCHEMA \"public\";

ALTER TABLE ONLY \"Products\"
\tALTER COLUMN product_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Users\"
\tALTER COLUMN user_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"SerialKeys\"
\tALTER COLUMN sk_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Purchases\"
\tALTER COLUMN purchase_id SET DEFAULT nextval('SerialGenerator'::regclass);
\t
ALTER TABLE ONLY \"Invoices\"
\tALTER COLUMN invoice_id SET DEFAULT nextval('SerialGenerator'::regclass);

*/
--deletes
DELETE FROM \"Users\";
DELETE FROM \"Sellers\";
DELETE FROM \"Products\";
DELETE FROM \"Discounts\";
DELETE FROM \"Purchases\";
DELETE FROM \"Reviews\";
DELETE FROM \"Wishlists\";
DELETE FROM \"ProductImages\";
DELETE FROM \"Tags\";
DELETE FROM \"SerialKeys\";

-- Users (user_id, username, password, fullname, email, phone_number, birth_date, admission_date, Userstate, admin, img, nif)
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(100, 'janedoe1', 'cheekybreeky', 'jane eleanor doer', 969420666, 'janedoe@gmail.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666420666);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(101, 'jenlong', 'oblivion', 'jenny long', 911999333, 'jenny.long84@example.com', '1973/7/10', '2018/2/20', 'Active', false, 'jenavatar.jpg', 666420777);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(102, 'everettdotnet', 'morrowind', 'everett adams', 969420444, 'everett.adams60@example.com', '1980/3/8', '2018/1/10', 'Active', false, 'eveavatar.jpg', 666420888);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(103, 'zdaroviaqueen', 'zdarovia', 'regina duncan', 969420555, 'regina.duncan44@example.com', '1990/1/1', '2018/3/11', 'Active', false, 'regavatar.jpg', 666420999);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(104, 'kentron', 'notoriousbig', 'ken gonzalez', 969420777, 'ken.gonzalez84@example.com', '1994/4/4', '2018/1/18', 'Active', false, 'tedavatar.jpg', 666421000);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(105, 'teddyboy', 'yeezytaughtme', 'ted mitchell', 969420888, 'ted.mitchell70@example.com', '1988/11/18', '2018/3/20', 'Active', false, 'janeavatar.jpg', 666421111);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(106, 'nottheactor', 'hoffhoff', 'dustin hoffman', 969420999, 'dustin.hoffman16@example.com', '1987/9/19', '2018/6/21', 'Active', false, 'dustavatar.jpg', 666421222);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(107, 'desugurippu', 'noided', 'michael arnold', 969420111, 'michael.arnold30@example.com', '1984/8/7', '2018/3/22', 'Active', false, 'micavatar.jpg', 666421333);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(108, 'normac', 'cardibandrum', 'norma cooper', 969420222, 'norma.cooper92@example.com', '1999/12/28', '2018/1/4', 'Active', false, 'normavatar.jpg', 666421444);
INSERT INTO \"Users\"(user_id, username, password, fullname, phone_number, email, birth_date, admission_date, state, admin, img, nif) VALUES(109, 'lilnina', 'groovey', 'nina sutton', 969420333, 'nina.sutton76@example.com', '1997/10/9', '2018/2/3', 'Active', false, 'ninavatar.jpg', 666421555);

-- Sellers (user_id, professional_email, professional_name, professional_phone)
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (105, 'ableton@gmail.com', 'ableton', 912345678);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (106, 'adobe@gmail.com', 'adobe', 913456789);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (107, 'microsoft@gmail.com', 'microsoft', 912543876);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (108, 'sony@gmail.com', 'sony', 913654987);
INSERT INTO \"Sellers\"(user_id, professional_email, professional_name, professional_phone) VALUES (109, 'blender@gmail.com', 'blender', 919876543);

-- Products (product_id, user_id, description, release_date, operating_system, price, logo_path, name)
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 200, 105, 'daw for live mixing and production', '2015/10/20', 'wml', 599, 'ableton9.jpg', 'ableton 9 live suite');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 201, 106, 'image editing software', '2016/2/14', 'wml', 599, 'photoshop.jpg', 'adobe photoshop');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 202, 107, 'programming ide', '2018/3/12', 'w', 199, 'visualstudio.jpg', 'visual studio 2018');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 203, 108, 'video editing software', '2014/1/22', 'wm', 299, 'sonyvegas.jpg', 'sony vegas pro');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 204, 109, '3d rendering and editing software', '2013/10/12', 'wml', 0, 'blender.jpg', 'blender');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 205, 105, 'synthetizer plug in for ableton', '2017/11/21', 'wml', 29, 'massive.jpg', 'ableton massive plugin');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 206, 106, 'vector graphic design software', '2016/4/1', 'wml', 99, 'ilustrator.jpg', 'adobe ilustrator');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 207, 107, 'programming text editor', '2017/11/10', 'w', 0, 'visualcode.jpg', 'microsoft visual code');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 208, 108, 'digital audio editing suite software', '2002/7/12', 'wm', 199, 'soundforge.jpg', 'sony sound forge');
INSERT INTO \"Products\" (hidden, product_id, user_id, description, release_date, operating_system, price, logo_path, name) VALUES (FALSE, 209, 109, 'dynamic mixing device', '2018/10/9', 'wml', 99, 'channelblender.jpg', 'channel blender');

-- Product Images (product_id, img_path)
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (200, 'abletonimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (201, 'photoshopimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (202, 'visualstudioimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (203, 'sonyvegasimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (204, 'blenderimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (205, 'massiveimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (206, 'ilustratorimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (207, 'visualcodeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (208, 'soundforgeimg1.jpg');
INSERT INTO \"ProductImages\"(product_id, img_path) VALUES (209, 'channelblenderimg1.jpg');

-- Tags (product_id, tag_name)
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (200, 'daw');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (201, 'image');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (202, 'programming');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (203, 'video');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (204, '3d');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (205, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (206, 'design');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (207, 'text');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (208, 'audio');
INSERT INTO \"Tags\"(product_id, tag_name) VALUES (209, '3d');

-- SerialKeys (sk_id, user_id, product_id, code)
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (500, 105, 200, '1J6B5JHG7I');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (501, 106, 201, '0FIAJ5N6B3');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (502, 107, 202, '09FUHRB5N6');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (503, 108, 203, 'S0HNS4K6HS');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (504, 109, 204, 'OFCJAGHI54');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (505, 105, 205, '0SAIDUFRKF');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (506, 106, 206, 'SGHUDIFOG3');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (507, 107, 207, '5URJEDKHA4');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (508, 108, 208, '38HUEDWXJH');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (509, 109, 209, 'IODIGHOI2N');
INSERT INTO \"SerialKeys\"(sk_id, user_id, product_id, code) VALUES (510, 109, 209, 'IODIGHOP2N');


-- Reviews (sk_id, rating, review_date, comment)
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (500, 4, '2018/3/1', 'very good product although a tad expensive');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (501, 5, '2017/4/12', 'i am amazed at this product it is very nice');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (502, 5, '2018/10/25', 'this is an incredible piece of software');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (503, 4, '2017/6/15', 'the product fulfills its purpose with precision');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (504, 3, '2018/2/5', 'hey thats pretty good');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (505, 5, '2018/8/14', 'i am astonished at how efficient this product is');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (506, 2, '2018/4/22', 'way too expensive for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (507, 4, '2017/10/30', 'way too cheap for the amount of features it comes with');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (508, 1, '2016/7/6', 'absolutely atrocious, barely works, cant even install it');
INSERT INTO \"Reviews\"(sk_id, rating, review_date, comment) VALUES (509, 3, '2018/12/14', 'its nice but there are way better options out there');

-- Discounts (product_id, discounted_rice, begin_date, end_date)
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (200, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (201, 20, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (202, 30, '2018/5/10', '2018/5/20');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (203, 20, '2018/12/1', '2019/1/4');
INSERT INTO \"Discounts\"(product_id, discounted_price, begin_date, end_date) VALUES (204, 15, '2018/4/1', '2018/4/30');

-- Purchases (purchase_id, final_price, user_id, sk_id, paid_date, paymentmethod, details)
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (800, 579, 100, '2018/4/21', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (801, 579, 101, '2018/6/12', 'Credit Card', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (802, 169, 102, '2018/5/2', 'PayPal', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (803, 279, 103, '2018/6/23', 'Banking Transfer', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (804, 14, 104, '2018/3/31', 'Banking Transfer', 'Minor setbacks contacting seller');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (805, 29, 100, '2018/1/26', 'Credit Card', 'Purchase sucessful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (806, 99, 101, '2018/8/1', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (807, 579, 102, '2018/11/4', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (808, 199, 103, '2018/3/10', 'PayPal', 'Purchase successful');
INSERT INTO \"Purchases\"(purchase_id, final_price, user_id, paid_date, payment_method, details) VALUES (809, 99, 104, '2018/9/2', 'Credit Card', 'Purchase successful');

-- Wishlists (user_id, product_id)
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (100, 209);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (101, 208);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (102, 207);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (103, 206);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (104, 205);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (105, 204);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (106, 203);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (107, 202);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (108, 201);
INSERT INTO \"Wishlists\"(user_id, product_id) VALUES (109, 200);

-- PurchasedKeys

INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (500, 800,32 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (501, 801, 53);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (502, 802, 66);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (503, 803,77 );
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (504, 804, 100);
INSERT INTO \"PurchasedKeys\"(sk_id, purchase_id, price) VALUES (505, 805,52 );) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42710): SQLSTATE[42710]: Duplicate object: 7 ERROR:  type \"invoicestate\" already exists at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:507)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('DROP TYPE IF EX...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(511): Illuminate\\Database\\Connection->run('DROP TYPE IF EX...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/DatabaseManager.php(327): Illuminate\\Database\\Connection->unprepared('DROP TYPE IF EX...')
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Support/Facades/Facade.php(221): Illuminate\\Database\\DatabaseManager->__call('unprepared', Array)
#4 /home/jotadaxter/Documents/Github/lbaw1744/database/seeds/DatabaseSeeder.php(17): Illuminate\\Support\\Facades\\Facade::__callStatic('unprepared', Array)
#5 [internal function]: DatabaseSeeder->run()
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Seeder.php(122): Illuminate\\Container\\Container->call(Array)
#11 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(63): Illuminate\\Database\\Seeder->__invoke()
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/GuardsAttributes.php(122): Illuminate\\Database\\Console\\Seeds\\SeedCommand->Illuminate\\Database\\Console\\Seeds\\{closure}()
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Console/Seeds/SeedCommand.php(64): Illuminate\\Database\\Eloquent\\Model::unguarded(Object(Closure))
#14 [internal function]: Illuminate\\Database\\Console\\Seeds\\SeedCommand->handle()
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(29): call_user_func_array(Array, Array)
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(87): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/BoundMethod.php(31): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#18 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Container/Container.php(549): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(183): Illuminate\\Container\\Container->call(Array)
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Command/Command.php(252): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Command.php(170): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(946): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(248): Symfony\\Component\\Console\\Application->doRunCommand(Object(Illuminate\\Database\\Console\\Seeds\\SeedCommand), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/symfony/console/Application.php(148): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Console/Application.php(88): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Console/Kernel.php(121): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#27 /home/jotadaxter/Documents/Github/lbaw1744/artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#28 {main}
"} 
[2018-04-28 14:32:34] local.ERROR: SQLSTATE[42P01]: Undefined table: 7 ERROR:  relation "users" does not exist
LINE 1: select * from "users" where "email" = $1 limit 1
                      ^ (SQL: select * from "users" where "email" = janedoe@gmail.com limit 1) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42P01): SQLSTATE[42P01]: Undefined table: 7 ERROR:  relation \"users\" does not exist
LINE 1: select * from \"users\" where \"email\" = $1 limit 1
                      ^ (SQL: select * from \"users\" where \"email\" = janedoe@gmail.com limit 1) at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:664, PDOException(code: 42P01): SQLSTATE[42P01]: Undefined table: 7 ERROR:  relation \"users\" does not exist
LINE 1: select * from \"users\" where \"email\" = $1 limit 1
                      ^ at /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php:330)
[stacktrace]
#0 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(624): Illuminate\\Database\\Connection->runQueryCallback('select * from \"...', Array, Object(Closure))
#1 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Connection.php(333): Illuminate\\Database\\Connection->run('select * from \"...', Array, Object(Closure))
#2 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(1707): Illuminate\\Database\\Connection->select('select * from \"...', Array, true)
#3 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(1692): Illuminate\\Database\\Query\\Builder->runSelect()
#4 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(479): Illuminate\\Database\\Query\\Builder->get(Array)
#5 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(463): Illuminate\\Database\\Eloquent\\Builder->getModels(Array)
#6 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Database/Concerns/BuildsQueries.php(77): Illuminate\\Database\\Eloquent\\Builder->get(Array)
#7 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Auth/EloquentUserProvider.php(121): Illuminate\\Database\\Eloquent\\Builder->first()
#8 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Auth/SessionGuard.php(351): Illuminate\\Auth\\EloquentUserProvider->retrieveByCredentials(Array)
#9 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Auth/AuthenticatesUsers.php(77): Illuminate\\Auth\\SessionGuard->attempt(Array, false)
#10 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Auth/AuthenticatesUsers.php(42): App\\Http\\Controllers\\Auth\\LoginController->attemptLogin(Object(Illuminate\\Http\\Request))
#11 [internal function]: App\\Http\\Controllers\\Auth\\LoginController->login(Object(Illuminate\\Http\\Request))
#12 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): call_user_func_array(Array, Array)
#13 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(45): Illuminate\\Routing\\Controller->callAction('login', Array)
#14 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Route.php(212): Illuminate\\Routing\\ControllerDispatcher->dispatch(Object(Illuminate\\Routing\\Route), Object(App\\Http\\Controllers\\Auth\\LoginController), 'login')
#15 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Route.php(169): Illuminate\\Routing\\Route->runController()
#16 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Router.php(658): Illuminate\\Routing\\Route->run()
#17 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(30): Illuminate\\Routing\\Router->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#18 /home/jotadaxter/Documents/Github/lbaw1744/app/Http/Middleware/RedirectIfAuthenticated.php(25): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#19 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): App\\Http\\Middleware\\RedirectIfAuthenticated->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#20 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#21 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(41): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#22 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Routing\\Middleware\\SubstituteBindings->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#23 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#24 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(67): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#25 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Foundation\\Http\\Middleware\\VerifyCsrfToken->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#26 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#27 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#28 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\View\\Middleware\\ShareErrorsFromSession->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#29 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#30 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(63): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#31 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Session\\Middleware\\StartSession->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#32 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#33 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#34 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#35 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#36 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(59): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#37 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Cookie\\Middleware\\EncryptCookies->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#38 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#39 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(102): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#40 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Router.php(660): Illuminate\\Pipeline\\Pipeline->then(Object(Closure))
#41 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Router.php(635): Illuminate\\Routing\\Router->runRouteWithinStack(Object(Illuminate\\Routing\\Route), Object(Illuminate\\Http\\Request))
#42 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Router.php(601): Illuminate\\Routing\\Router->runRoute(Object(Illuminate\\Http\\Request), Object(Illuminate\\Routing\\Route))
#43 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Router.php(590): Illuminate\\Routing\\Router->dispatchToRoute(Object(Illuminate\\Http\\Request))
#44 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\\Routing\\Router->dispatch(Object(Illuminate\\Http\\Request))
#45 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(30): Illuminate\\Foundation\\Http\\Kernel->Illuminate\\Foundation\\Http\\{closure}(Object(Illuminate\\Http\\Request))
#46 /home/jotadaxter/Documents/Github/lbaw1744/vendor/fideloper/proxy/src/TrustProxies.php(56): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#47 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Fideloper\\Proxy\\TrustProxies->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#48 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#49 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(30): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#50 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Foundation\\Http\\Middleware\\TransformsRequest->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#51 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#52 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(30): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#53 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Foundation\\Http\\Middleware\\TransformsRequest->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#54 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#55 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#56 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Foundation\\Http\\Middleware\\ValidatePostSize->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#57 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#58 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/CheckForMaintenanceMode.php(46): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#59 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(149): Illuminate\\Foundation\\Http\\Middleware\\CheckForMaintenanceMode->handle(Object(Illuminate\\Http\\Request), Object(Closure))
#60 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Routing/Pipeline.php(53): Illuminate\\Pipeline\\Pipeline->Illuminate\\Pipeline\\{closure}(Object(Illuminate\\Http\\Request))
#61 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(102): Illuminate\\Routing\\Pipeline->Illuminate\\Routing\\{closure}(Object(Illuminate\\Http\\Request))
#62 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(151): Illuminate\\Pipeline\\Pipeline->then(Object(Closure))
#63 /home/jotadaxter/Documents/Github/lbaw1744/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(116): Illuminate\\Foundation\\Http\\Kernel->sendRequestThroughRouter(Object(Illuminate\\Http\\Request))
#64 /home/jotadaxter/Documents/Github/lbaw1744/public/index.php(55): Illuminate\\Foundation\\Http\\Kernel->handle(Object(Illuminate\\Http\\Request))
#65 /home/jotadaxter/Documents/Github/lbaw1744/server.php(21): require_once('/home/jotadaxte...')
#66 {main}
"} 
